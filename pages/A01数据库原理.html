<!DOCTYPE html><html><head>
      <title>A01数据库原理</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="/pages/katex/katex.min.css">
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 align="middle">数据库原理</h1>
<div align="right">最近更新时间：2024-01-04</div>
<h2 id="关系型数据库理论">关系型数据库理论 </h2>
<p><strong>数据库分类</strong>：关系型数据库（如MySQL）、非关系型数据库（如Redis）</p>
<h3 id="三要素">三要素 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">三要素</th>
<th style="text-align:center">内容</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">关系数据结构</td>
<td style="text-align:center">二维表</td>
</tr>
<tr>
<td style="text-align:center">关系操作</td>
<td style="text-align:center">增删改查（关系代数语言，关系演算语言，综合性的SQL）</td>
</tr>
<tr>
<td style="text-align:center">完整性约束</td>
<td style="text-align:center">实体完整性、参照完整性、自定义完整性</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">要素一：关系数据结构术语</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">关系模式</td>
<td style="text-align:center">表格的表头</td>
</tr>
<tr>
<td style="text-align:center">域、属性</td>
<td style="text-align:center">表格的列</td>
</tr>
<tr>
<td style="text-align:center">关系、元组</td>
<td style="text-align:center">表格的内容行</td>
</tr>
<tr>
<td style="text-align:center">码</td>
<td style="text-align:center">由一个或多个属性构成，能唯一标识每个元组</td>
</tr>
<tr>
<td style="text-align:center">候选码</td>
<td style="text-align:center">所有符合条件的码</td>
</tr>
<tr>
<td style="text-align:center">主码、主键</td>
<td style="text-align:center">从候选码中，选出的1个</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">要素二：关系操作术语</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">关系代数语言</td>
<td style="text-align:center">查询操作时是<strong>集合操作</strong>为基础运算的语言</td>
</tr>
<tr>
<td style="text-align:center">关系演算语言</td>
<td style="text-align:center">查询操作是以<strong>谓词演算</strong>为基础运算的语言</td>
</tr>
<tr>
<td style="text-align:center">综合性的SQL</td>
<td style="text-align:center">综合关系代数语言、关系演算语言特点的DDL、DML、DQL、DCL语言</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">要素三：完整性约束术语</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">实体完整性</td>
<td style="text-align:center">关系中不能有完全相同的元组</td>
</tr>
<tr>
<td style="text-align:center">参照完整性</td>
<td style="text-align:center">参照的所有属性及内容，必须是被参照表所有的</td>
</tr>
<tr>
<td style="text-align:center">自定义完整性</td>
<td style="text-align:center">自定义的取值限制</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">关系代数表示</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">交<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span>、并<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">\cup</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span>、差<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span></span></span></span></td>
<td style="text-align:center">集合基础运算</td>
</tr>
<tr>
<td style="text-align:center">笛卡尔积<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">×</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">×</span></span></span></span></td>
<td style="text-align:center">不同表的所有组合</td>
</tr>
<tr>
<td style="text-align:center">投影<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span></td>
<td style="text-align:center">只显示某列，同SELECET...</td>
</tr>
<tr>
<td style="text-align:center">选择<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></td>
<td style="text-align:center">选择符合条件的，同WHERE...</td>
</tr>
<tr>
<td style="text-align:center">重命名<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></td>
<td style="text-align:center">重命名，同AS...</td>
</tr>
<tr>
<td style="text-align:center">辅助运算符</td>
<td style="text-align:center">比较运算符<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mo>&lt;</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">&gt;&lt;=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;&lt;=</span></span></span></span>、逻辑运算符<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∨</mo><mo>∧</mo><mo>−</mo></mrow><annotation encoding="application/x-tex">\vee \wedge-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span></span></span></span></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="er图">ER图 </h3>
<p><strong>概念</strong>：实体联系图，用来建立数据模型</p>
<table>
<thead>
<tr>
<th style="text-align:center">ER图三要素</th>
<th style="text-align:center">表示</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">实体型</td>
<td style="text-align:center">矩形</td>
<td style="text-align:center">\</td>
</tr>
<tr>
<td style="text-align:center">属性</td>
<td style="text-align:center">椭圆形</td>
<td style="text-align:center">主属性下划线</td>
</tr>
<tr>
<td style="text-align:center">联系</td>
<td style="text-align:center">菱形</td>
<td style="text-align:center">两端写上关系类型</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>关系类型</strong>：1:1型，n:1型，n:m型</li>
</ul>
<img src="./images/2023-08-03-18-41-image.png">
<hr>
<h3 id="uml图">UML图 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">例图</td>
<td style="text-align:center">用户角度，指定各功能的操作者</td>
</tr>
<tr>
<td style="text-align:center">静态图</td>
<td style="text-align:center">包括类图、对象图、聚合等</td>
</tr>
<tr>
<td style="text-align:center">行为图</td>
<td style="text-align:center">描述动态模型和组成对象间的交互关系</td>
</tr>
<tr>
<td style="text-align:center">交互图</td>
<td style="text-align:center">描述对象间的交互关系</td>
</tr>
<tr>
<td style="text-align:center">实现图</td>
<td style="text-align:center">各代码部件物理结构和各部件之间的依赖关系</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="规范化理论">规范化理论 </h3>
<p><strong>概念</strong>：通过分解改造逻辑模型的关系模式。</p>
<table>
<thead>
<tr>
<th style="text-align:center">术语</th>
<th style="text-align:center">表示</th>
<th style="text-align:center">说明</th>
<th style="text-align:center">例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A→B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></td>
<td style="text-align:center">每个A值都有唯一B值与之对应</td>
<td style="text-align:center">\</td>
</tr>
<tr>
<td style="text-align:center">完全函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mspace width="1em"></mspace><munder accentunder="true"><mi>f</mi><mo stretchy="true">→</mo></munder><mspace width="1em"></mspace><mi>B</mi></mrow><annotation encoding="application/x-tex">A\quad\underrightarrow{f}\quad B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4109em;vertical-align:-0.7164em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:1em;"></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span class="svg-align" style="top:-2.2836em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7164em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></td>
<td style="text-align:center">B值依赖于全部A值</td>
<td style="text-align:center">学号→选课</td>
</tr>
<tr>
<td style="text-align:center">部分函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mspace width="1em"></mspace><munder accentunder="true"><mi>p</mi><mo stretchy="true">→</mo></munder><mspace width="1em"></mspace><mi>B</mi></mrow><annotation encoding="application/x-tex">A\quad\underrightarrow{p}\quad B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3998em;vertical-align:-0.7164em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:1em;"></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span class="svg-align" style="top:-2.2836em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7164em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></td>
<td style="text-align:center">B值依赖于A值的真子集</td>
<td style="text-align:center">(学号,姓名)→选课</td>
</tr>
<tr>
<td style="text-align:center">传递函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mtext>，且</mtext><mi>B</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A→B，且B→C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">，且</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A→C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>是传递依赖</td>
<td style="text-align:center">学号→选课→教师</td>
</tr>
<tr>
<td style="text-align:center">非平凡函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mtext>，且</mtext><mi>B</mi><mtext>⊄</mtext><mi>A</mi></mrow><annotation encoding="application/x-tex">A→B，且B⊄A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">，且</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">⊄</span><span class="mord mathnormal">A</span></span></span></span></td>
<td style="text-align:center">B值依赖且非来源于A值</td>
<td style="text-align:center">学号→选课</td>
</tr>
<tr>
<td style="text-align:center">平凡函数依赖</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mtext>，且</mtext><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A→B，且B⊆A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">，且</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></td>
<td style="text-align:center">B值依赖且来源于A值</td>
<td style="text-align:center">学号→同桌</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">范式</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">第一范式，1NF</td>
<td style="text-align:center">关系模式不可直接再分</td>
</tr>
<tr>
<td style="text-align:center">第二范式，2NF</td>
<td style="text-align:center">消除非主属性的部分函数依赖</td>
</tr>
<tr>
<td style="text-align:center">第三范式，3NF</td>
<td style="text-align:center">消除非主属性的传递函数依赖</td>
</tr>
<tr>
<td style="text-align:center">BC范式，BCNF</td>
<td style="text-align:center">消除主属性的部分和传递函数依赖</td>
</tr>
<tr>
<td style="text-align:center">第四范式，4NF</td>
<td style="text-align:center">消除非平凡且非函数依赖的多值依赖</td>
</tr>
<tr>
<td style="text-align:center">第五范式，5NF</td>
<td style="text-align:center">消除不是由候选码所蕴含的连接依赖</td>
</tr>
</tbody>
</table>
<ul>
<li>恢复时与分解前的数据保持一致，分解后函数依赖保持不变。</li>
</ul>
<hr>
<h2 id="sql基础语法">SQL基础语法 </h2>
<h3 id="ddl">DDL </h3>
<p><strong>概念</strong>：date description language数据描述语言，用以数据库和表格的增删改查。</p>
<h4 id="数据库ddl">数据库DDL </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-database">database</span> 数据库名<span class="token punctuation">;</span>

<span class="token keyword keyword-use">use</span> 数据库名<span class="token punctuation">;</span>

<span class="token keyword keyword-drop">drop</span> 数据库名<span class="token punctuation">;</span>
</code></pre><hr>
<h4 id="表格ddl">表格DDL </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-table">table</span> 表名<span class="token punctuation">(</span>
    属性名<span class="token number">1</span> 数据类型<span class="token punctuation">,</span>
    属性名<span class="token number">2</span> 数据类型 完整性约束 完整性约束<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    表格完整性约束<span class="token punctuation">(</span>属性名<span class="token number">1</span><span class="token punctuation">,</span>属性名<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-add">add</span> 属性名 数据类型 完整性约束<span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-drop">drop</span> <span class="token keyword keyword-column">column</span> 属性名<span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-drop">drop</span> 完整性约束<span class="token punctuation">(</span>属性名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-add">add</span> 完整性约束<span class="token punctuation">(</span>属性名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-modify">modify</span> 属性名 数据类型 完整性约束<span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-rename">rename</span> <span class="token keyword keyword-to">to</span> 新表名<span class="token punctuation">;</span>

<span class="token keyword keyword-drop">drop</span> <span class="token keyword keyword-table">table</span> 表名<span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">tinyint</td>
<td style="text-align:center">1B整数</td>
</tr>
<tr>
<td style="text-align:center">smallint</td>
<td style="text-align:center">2B整数</td>
</tr>
<tr>
<td style="text-align:center">mediumint</td>
<td style="text-align:center">3B整数</td>
</tr>
<tr>
<td style="text-align:center">int</td>
<td style="text-align:center">4B整数</td>
</tr>
<tr>
<td style="text-align:center">bigint</td>
<td style="text-align:center">8B整数</td>
</tr>
<tr>
<td style="text-align:center">int unsigned</td>
<td style="text-align:center">无符号4B整数</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">单精浮点数</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">双精浮点数</td>
</tr>
<tr>
<td style="text-align:center">real</td>
<td style="text-align:center">默认double</td>
</tr>
<tr>
<td style="text-align:center">decimal(M,D)</td>
<td style="text-align:center">定点数</td>
</tr>
<tr>
<td style="text-align:center">bit(M)</td>
<td style="text-align:center">二进制，比特数</td>
</tr>
<tr>
<td style="text-align:center">binary(M)</td>
<td style="text-align:center">二进制，字节数</td>
</tr>
<tr>
<td style="text-align:center">varbinary(M)</td>
<td style="text-align:center">可变二进制，字节数</td>
</tr>
<tr>
<td style="text-align:center">blob(M)</td>
<td style="text-align:center">二进制大对象，存图片、音频等文件的二进制数据流</td>
</tr>
<tr>
<td style="text-align:center">year</td>
<td style="text-align:center">表示YYYY</td>
</tr>
<tr>
<td style="text-align:center">data</td>
<td style="text-align:center">表示YYYY-MM-DD</td>
</tr>
<tr>
<td style="text-align:center">datatime</td>
<td style="text-align:center">表示YYYY-MM-DD HH:MM:SS</td>
</tr>
<tr>
<td style="text-align:center">timestamp</td>
<td style="text-align:center">从1970年1月1日8点开始的时间戳</td>
</tr>
<tr>
<td style="text-align:center">char(M)</td>
<td style="text-align:center">字符型</td>
</tr>
<tr>
<td style="text-align:center">varchar(M)</td>
<td style="text-align:center">可变字符型</td>
</tr>
<tr>
<td style="text-align:center">enum</td>
<td style="text-align:center">枚举型</td>
</tr>
<tr>
<td style="text-align:center">set</td>
<td style="text-align:center">集合型</td>
</tr>
<tr>
<td style="text-align:center">json</td>
<td style="text-align:center">json字符串</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">完整性约束</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">primary key</td>
<td style="text-align:center">主键</td>
</tr>
<tr>
<td style="text-align:center">not null</td>
<td style="text-align:center">非空限制</td>
</tr>
<tr>
<td style="text-align:center">unique</td>
<td style="text-align:center">唯一限制</td>
</tr>
<tr>
<td style="text-align:center">check(属性名&lt;=56)</td>
<td style="text-align:center">取值限制</td>
</tr>
<tr>
<td style="text-align:center">auto_increment=初始值</td>
<td style="text-align:center">自动按初始值自增</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="dql">DQL </h3>
<p><strong>概念</strong>：data query language，数据查询语言，对表格中元组实例的查询操作。</p>
<h4 id="单表dql">单表DQL </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-select">select</span> <span class="token keyword keyword-distinct">distinct</span> 属性名<span class="token number">1</span> <span class="token keyword keyword-as">as</span> 属性别名<span class="token punctuation">,</span>属性名<span class="token number">2</span><span class="token punctuation">,</span>属性名<span class="token number">3.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword keyword-from">from</span> 表名
<span class="token keyword keyword-where">where</span> 筛选条件
<span class="token keyword keyword-group">group</span> <span class="token keyword keyword-by">by</span> 属性名
<span class="token keyword keyword-having">having</span> 分组条件
<span class="token keyword keyword-order">order</span> <span class="token keyword keyword-by">by</span> 属性名 <span class="token keyword keyword-desc">desc</span><span class="token punctuation">,</span>属性名<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword keyword-limit">limit</span> 结果展示起始行<span class="token punctuation">,</span>每页展示数<span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th style="text-align:center">可省略关键词</th>
<th style="text-align:center">意义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">distinct</td>
<td style="text-align:center">结果去重</td>
</tr>
<tr>
<td style="text-align:center">as</td>
<td style="text-align:center">属性起别名</td>
</tr>
<tr>
<td style="text-align:center">desc</td>
<td style="text-align:center">改降序</td>
</tr>
<tr>
<td style="text-align:center">from</td>
<td style="text-align:center">元组筛选条件</td>
</tr>
<tr>
<td style="text-align:center">group by</td>
<td style="text-align:center">以某属性名分组</td>
</tr>
<tr>
<td style="text-align:center">having</td>
<td style="text-align:center">筛选可分组的属性名</td>
</tr>
<tr>
<td style="text-align:center">order by</td>
<td style="text-align:center">以多级属性为比对，进行排序</td>
</tr>
<tr>
<td style="text-align:center">limit</td>
<td style="text-align:center">单页展示</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">条件辅助关键词</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">and</td>
<td style="text-align:center">与</td>
</tr>
<tr>
<td style="text-align:center">or</td>
<td style="text-align:center">或</td>
</tr>
<tr>
<td style="text-align:center">not</td>
<td style="text-align:center">非</td>
</tr>
<tr>
<td style="text-align:center">xor</td>
<td style="text-align:center">异或</td>
</tr>
<tr>
<td style="text-align:center">between</td>
<td style="text-align:center">在...之间</td>
</tr>
<tr>
<td style="text-align:center">in</td>
<td style="text-align:center">符合集合中的任一个</td>
</tr>
<tr>
<td style="text-align:center">like</td>
<td style="text-align:center">模糊匹配：多位%&nbsp; &nbsp; 单位_&nbsp; &nbsp; 除了ESCAPE</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="多表dql">多表DQL </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-select">select</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> 表一<span class="token punctuation">,</span>表二<span class="token punctuation">;</span>    <span class="token comment">//笛卡尔积，隐式内连接</span>

<span class="token keyword keyword-select">select</span> 表一<span class="token punctuation">.</span>属性名<span class="token punctuation">,</span>表二<span class="token punctuation">.</span>属性名
<span class="token keyword keyword-from">from</span> 表一<span class="token punctuation">,</span>表二
<span class="token keyword keyword-where">where</span> 等值条件<span class="token punctuation">;</span>    <span class="token comment">//等值连接，隐式内连接</span>

<span class="token keyword keyword-select">select</span> 表一<span class="token punctuation">.</span>属性名<span class="token punctuation">,</span>表二<span class="token punctuation">.</span>属性名
<span class="token keyword keyword-from">from</span> 表一 <span class="token keyword keyword-join">join</span> 表二 <span class="token keyword keyword-on">on</span> 等值条件
<span class="token keyword keyword-where">where</span> 筛选条件<span class="token punctuation">;</span>    <span class="token comment">//显示内连接</span>

<span class="token keyword keyword-select">select</span> 表一<span class="token punctuation">.</span>属性名<span class="token punctuation">,</span>表二<span class="token punctuation">.</span>属性名
<span class="token keyword keyword-from">from</span> 表一 <span class="token keyword keyword-left">left</span> <span class="token keyword keyword-join">join</span> 表二 <span class="token keyword keyword-on">on</span> 等值条件
<span class="token keyword keyword-where">where</span> 筛选条件<span class="token punctuation">;</span>    <span class="token comment">//显示左连接</span>

<span class="token keyword keyword-select">select</span> 表一<span class="token punctuation">.</span>属性名<span class="token punctuation">,</span>表二<span class="token punctuation">.</span>属性名
<span class="token keyword keyword-from">from</span> 表一 <span class="token keyword keyword-right">right</span> <span class="token keyword keyword-join">join</span> 表二 <span class="token keyword keyword-on">on</span> 等值条件
<span class="token keyword keyword-where">where</span> 筛选条件<span class="token punctuation">;</span>    <span class="token comment">//显示右连接</span>
</code></pre><hr>
<h4 id="嵌套dql">嵌套DQL </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-select">select</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> 表名 <span class="token keyword keyword-where">where</span> 属性名 <span class="token operator">=</span> <span class="token punctuation">(</span>标量子查询DQL语句<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-select">select</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> 表名 <span class="token keyword keyword-where">where</span> 属性名 <span class="token operator">in</span> <span class="token punctuation">(</span>列子查询DQL语句<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-select">select</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> 表名 <span class="token keyword keyword-where">where</span> <span class="token punctuation">(</span>属性名<span class="token punctuation">,</span>属性名<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>行子查询DQL语句<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-select">select</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> （表子查询DQL语句） <span class="token keyword keyword-where">where</span> 条件<span class="token punctuation">;</span>

<span class="token punctuation">(</span>子查询DQL语句<span class="token punctuation">)</span> <span class="token keyword keyword-UNION">UNION</span> <span class="token punctuation">(</span>子查询DQL语句<span class="token punctuation">)</span>    <span class="token comment">//并集</span>
</code></pre><hr>
<h3 id="dml">DML </h3>
<p><strong>概念</strong>：data manipulation language，数据操作语言，对表格元组的增删改操作。</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-insert">insert</span> <span class="token keyword keyword-into">into</span> 表名 <span class="token punctuation">(</span>属性名<span class="token number">1</span><span class="token punctuation">,</span>属性名<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-values">values</span> <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-update">update</span> 表名 <span class="token keyword keyword-set">set</span> 属性名<span class="token operator">=</span>值 <span class="token keyword keyword-where">where</span> 条件<span class="token punctuation">;</span>

<span class="token keyword keyword-delete">delete</span> <span class="token keyword keyword-from">from</span> 表名 <span class="token keyword keyword-where">where</span> 条件<span class="token punctuation">;</span> 

<span class="token keyword keyword-truncate">truncate</span> 表名<span class="token punctuation">;</span>    <span class="token comment">//相当于drop后create，速度比delete块。</span>
</code></pre><hr>
<h3 id="dcl">DCL </h3>
<p><strong>概念</strong>：data control language，数据控制语言，用户管理，权限管理等安全性操作</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-user">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span>    <span class="token comment">//主机名可用%，进行模糊匹配</span>
identified <span class="token keyword keyword-by">by</span> 密码<span class="token punctuation">;</span>

<span class="token keyword keyword-alter">alter</span> <span class="token keyword keyword-user">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span>
identified <span class="token keyword keyword-with">with</span> mysql_native_password <span class="token keyword keyword-by">by</span> 新密码<span class="token punctuation">;</span>

<span class="token keyword keyword-drop">drop</span> <span class="token keyword keyword-user">user</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span><span class="token punctuation">;</span>

<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-grant">grant</span> <span class="token keyword keyword-for">for</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span><span class="token punctuation">;</span>

<span class="token keyword keyword-grant">grant</span> 权限<span class="token punctuation">,</span>权限<span class="token punctuation">(</span>属性名<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword keyword-on">on</span> <span class="token keyword keyword-table">table</span> 名
<span class="token keyword keyword-to">to</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span>
<span class="token keyword keyword-with">with</span> <span class="token keyword keyword-grant">grant</span> <span class="token keyword keyword-option">option</span><span class="token punctuation">;</span>    <span class="token comment">//可选，被授予者可以授予其他人</span>

<span class="token keyword keyword-revoke">revoke</span> 权限<span class="token punctuation">,</span>权限<span class="token punctuation">(</span>属性名<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>、
<span class="token keyword keyword-on">on</span> <span class="token keyword keyword-table">table</span> 表名
<span class="token keyword keyword-from">from</span> <span class="token string">'用户名'</span><span class="token variable">@'主机名'</span><span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th style="text-align:center">权限</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">replication slave</td>
<td style="text-align:center">全部权限</td>
</tr>
<tr>
<td style="text-align:center">insert、delete、updata、select...</td>
<td style="text-align:center">个别增删改查等权限</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="sql扩展语法">SQL扩展语法 </h2>
<h3 id="视图">视图 </h3>
<p><strong>概念</strong>：依据查询结果创建视图，可以提高数据的安全性、独立性。</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-view">view</span> 视图名 <span class="token keyword keyword-as">as</span> DQL语句<span class="token punctuation">;</span>

<span class="token keyword keyword-create">create</span> <span class="token keyword keyword-view">view</span> 视图名 <span class="token keyword keyword-as">as</span> DQL语句 <span class="token keyword keyword-with">with</span> <span class="token keyword keyword-check">check</span> <span class="token keyword keyword-option">option</span><span class="token punctuation">;</span>    <span class="token comment">//更新，保持一致</span>

<span class="token keyword keyword-create">create</span> <span class="token keyword keyword-view">view</span> 视图名 <span class="token keyword keyword-as">as</span> DQL语句 <span class="token keyword keyword-with">with</span> <span class="token keyword keyword-local">local</span> <span class="token keyword keyword-check">check</span> <span class="token keyword keyword-option">option</span><span class="token punctuation">;</span>    <span class="token comment">//多级视图不传递</span>

<span class="token keyword keyword-create">create</span> <span class="token keyword keyword-view">view</span> 视图名 <span class="token keyword keyword-as">as</span> DQL语句 <span class="token keyword keyword-with">with</span> <span class="token keyword keyword-cascaded">cascaded</span> <span class="token keyword keyword-check">check</span> <span class="token keyword keyword-option">option</span><span class="token punctuation">;</span><span class="token comment">//多级视图更新传递---</span>
</code></pre><h3 id="索引">索引 </h3>
<p><strong>概念</strong>：建立索引可以提高SQL语句执行速度，索引是B+树结构。</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-index">index</span> 索引名 <span class="token keyword keyword-on">on</span> 表名<span class="token punctuation">(</span>属性名 <span class="token keyword keyword-desc">desc</span><span class="token punctuation">,</span>属性<span class="token punctuation">)</span>

<span class="token keyword keyword-create">create</span> <span class="token keyword keyword-index">index</span> 索引名 <span class="token keyword keyword-on">on</span> 表名<span class="token punctuation">(</span>属性名<span class="token punctuation">(</span>前缀数<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//前缀索引</span>

<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-index">index</span> <span class="token keyword keyword-from">from</span> 表名<span class="token punctuation">;</span>

<span class="token keyword keyword-drop">drop</span> <span class="token keyword keyword-index">index</span> 索引名 <span class="token keyword keyword-on">on</span> 表名<span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th>术语</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>聚簇索引cluster</td>
<td>自动在主键建立，叶子结点是一行的全部数据，无需回表查询</td>
</tr>
<tr>
<td>辅助索引</td>
<td>叶子结点只有主键的值，可能需要回表查询</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>回表查询：在辅助索引找不到全部所需数据，而再到聚簇索引进行查找</p>
</li>
<li>
<p>覆盖查询：无需回表，建立索引的1-n个属性名已经包含全部所需数据。</p>
</li>
<li>
<p>联合索引：对多个属性联合建立索引</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>索引失效</th>
</tr>
</thead>
<tbody>
<tr>
<td>在索引列上进行运算操作</td>
</tr>
<tr>
<td>字符串不加单引号</td>
</tr>
<tr>
<td>头部使用模糊查询</td>
</tr>
<tr>
<td>or连接的两端有一端没有索引</td>
</tr>
<tr>
<td>当前查询的数据占绝大部分</td>
</tr>
</tbody>
</table>
<ul>
<li>联合索引的<strong>最左前缀法则</strong>：跳过最左属性，索引全部失效，跳过中间属性，索引部分失效，用&gt; &lt;部分失效，用&gt;= &lt;=不会失效。</li>
</ul>
<table>
<thead>
<tr>
<th>SQL提示</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>use index(索引名)</td>
<td><strong>建议</strong>使用某索引查询</td>
</tr>
<tr>
<td>ignore index(索引名)</td>
<td><strong>忽视</strong>某索引查询</td>
</tr>
<tr>
<td>force index(索引名)</td>
<td><strong>强制</strong>使用某索引查询</td>
</tr>
</tbody>
</table>
<ul>
<li>用在DQL的from 表名后面。</li>
</ul>
<hr>
<h3 id="变量">变量 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-show">show</span> <span class="token keyword keyword-session">session</span> variables<span class="token punctuation">;</span>    <span class="token comment">//系统变量，查看全部局部</span>
<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-global">global</span> variables<span class="token punctuation">;</span>    <span class="token comment">//系统变量，查看全部全局</span>

<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-global">global</span> variables <span class="token operator">like</span> 模糊匹配词<span class="token punctuation">;</span>    <span class="token comment">//系统变量，模糊匹配</span>

<span class="token keyword keyword-show">show</span> @<span class="token variable">@global.</span>变量名<span class="token punctuation">;</span>    <span class="token comment">//系统变量，具体查询</span>

<span class="token keyword keyword-set">set</span> <span class="token keyword keyword-global">global</span> 变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>    <span class="token comment">//系统变量，赋值</span>

<span class="token keyword keyword-set">set</span> @变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>    <span class="token comment">//用户变量，定义赋值</span>

<span class="token keyword keyword-declare">declare</span> 变量名 变量类型 <span class="token keyword keyword-default">default</span> 默认值<span class="token punctuation">;</span>    <span class="token comment">//局部变量，定义</span>

<span class="token keyword keyword-set">set</span> 变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>    <span class="token comment">//局部变量，赋值</span>
</code></pre><hr>
<h3 id="游标">游标 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-declare">declare</span> 游标名 <span class="token keyword keyword-cursor">cursor</span> <span class="token keyword keyword-for">for</span> DQL语句<span class="token punctuation">;</span>

<span class="token keyword keyword-open">open</span> 游标名<span class="token punctuation">;</span>

<span class="token keyword keyword-fetch">fetch</span> 游标名 <span class="token keyword keyword-into">into</span> <span class="token number">1</span>到n个变量<span class="token punctuation">;</span>

<span class="token keyword keyword-close">close</span> 游标名<span class="token punctuation">;</span>
</code></pre><hr>
<h3 id="存储过程">存储过程 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-procedure">procedure</span> 过程名<span class="token punctuation">(</span>出进类型 形参 变量类型<span class="token punctuation">)</span>
<span class="token keyword keyword-begin">begin</span>
    过程体<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>

<span class="token keyword keyword-call">call</span> 过程名<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-create">create</span> <span class="token keyword keyword-procedure">procedure</span> 过程名<span class="token punctuation">;</span>

<span class="token keyword keyword-show">show</span> <span class="token operator">*</span> <span class="token keyword keyword-from">from</span> information_schema<span class="token punctuation">.</span>routines <span class="token keyword keyword-where">where</span> routines_schema <span class="token operator">=</span> <span class="token string">'表名'</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>
<p>命令行写的话需要定义结束符：delimiter $</p>
</li>
<li>
<p>出进类型：进in、出out、出进inout</p>
</li>
</ul>
<hr>
<h3 id="存储函数">存储函数 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-function">function</span> 函数名<span class="token punctuation">(</span>形参 变量类型<span class="token punctuation">)</span> <span class="token keyword keyword-returns">returns</span> 变量类型 <span class="token keyword keyword-deterministic">deterministic</span>
<span class="token keyword keyword-begin">begin</span>
    函数体<span class="token punctuation">;</span>
<span class="token keyword keyword-return">return</span> 返回值<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>

<span class="token keyword keyword-call">call</span> 函数名<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><hr>
<h3 id="sql函数">SQL函数 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">字符串函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">concat(str1,str2,...)</td>
<td style="text-align:center">字符串拼接</td>
</tr>
<tr>
<td style="text-align:center">lower(str)</td>
<td style="text-align:center">全转小写</td>
</tr>
<tr>
<td style="text-align:center">upper(str)</td>
<td style="text-align:center">全转大写</td>
</tr>
<tr>
<td style="text-align:center">lpad(str,n,pad)</td>
<td style="text-align:center">左填充pad至总n个字符</td>
</tr>
<tr>
<td style="text-align:center">rpad(str,n,pad)</td>
<td style="text-align:center">右填充pad至总n个字符</td>
</tr>
<tr>
<td style="text-align:center">trim(str)</td>
<td style="text-align:center">去除首尾空格</td>
</tr>
<tr>
<td style="text-align:center">substring(str,start,len)</td>
<td style="text-align:center">截取字符串</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">数学函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ceil(n)</td>
<td style="text-align:center">向上取整</td>
</tr>
<tr>
<td style="text-align:center">floor(n)</td>
<td style="text-align:center">向下取整</td>
</tr>
<tr>
<td style="text-align:center">mod(n,m)</td>
<td style="text-align:center">n%m</td>
</tr>
<tr>
<td style="text-align:center">rand()</td>
<td style="text-align:center">生成0-1随机数</td>
</tr>
<tr>
<td style="text-align:center">round(n,m)</td>
<td style="text-align:center">保留m为小数</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">日期函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">curdata()</td>
<td style="text-align:center">获取当前年月日</td>
</tr>
<tr>
<td style="text-align:center">curtime()</td>
<td style="text-align:center">获取当前时间</td>
</tr>
<tr>
<td style="text-align:center">now()</td>
<td style="text-align:center">获取当前的年月日时间</td>
</tr>
<tr>
<td style="text-align:center">year(data)</td>
<td style="text-align:center">获取指定data的YYYY</td>
</tr>
<tr>
<td style="text-align:center">month(data)</td>
<td style="text-align:center">获取指定data的MM</td>
</tr>
<tr>
<td style="text-align:center">day(data)</td>
<td style="text-align:center">获取指定data的DD</td>
</tr>
<tr>
<td style="text-align:center">data_add(data,interval 70 day)</td>
<td style="text-align:center">计算data70天前的日期</td>
</tr>
<tr>
<td style="text-align:center">datadiff(data1,data2)</td>
<td style="text-align:center">获取间隔天数，前减后</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">流程函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">if(value,t,f)</td>
<td style="text-align:center">三目运算符</td>
</tr>
<tr>
<td style="text-align:center">ifnull(value1,value2)</td>
<td style="text-align:center">判空value1，非空value1，空value2</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="判断语句">判断语句 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-if">if</span> 条件 
    <span class="token keyword keyword-then">then</span> 内容<span class="token punctuation">;</span>
    <span class="token keyword keyword-elseif">elseif</span> 条件 <span class="token keyword keyword-then">then</span> 内容<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">;</span>

<span class="token keyword keyword-case">case</span>
    <span class="token keyword keyword-when">when</span> 条件 <span class="token keyword keyword-then">then</span> 值<span class="token punctuation">;</span>
    <span class="token keyword keyword-when">when</span> 条件 <span class="token keyword keyword-then">then</span> 值<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-case">case</span><span class="token punctuation">;</span>
</code></pre><hr>
<h3 id="循环语句">循环语句 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-while">while</span> 条件
    <span class="token keyword keyword-do">do</span> 循环体<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-while">while</span><span class="token punctuation">;</span>

<span class="token keyword keyword-repeat">repeat</span> 循环体<span class="token punctuation">;</span>
until 条件 <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-repeat">repeat</span><span class="token punctuation">;</span>

名称:<span class="token keyword keyword-loop">loop</span> 循环体<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-loop">loop</span> 名称<span class="token punctuation">;</span>
</code></pre><ul>
<li>leave：退出循环break，iterate：进入下轮循环continue</li>
</ul>
<hr>
<h3 id="触发器">触发器 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-create">create</span> <span class="token keyword keyword-trigger">trigger</span> 触发器名 before <span class="token keyword keyword-SQL">SQL</span>关键字 <span class="token keyword keyword-on">on</span> 表名 <span class="token keyword keyword-for each row">for each row</span>
<span class="token keyword keyword-begin">begin</span>
    触发器体<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span> 

<span class="token keyword keyword-show">show</span> <span class="token keyword keyword-trigger">trigger</span><span class="token punctuation">;</span>

<span class="token keyword keyword-drop">drop</span> <span class="token keyword keyword-trigger">trigger</span> 触发器名<span class="token punctuation">;</span>
</code></pre><ul>
<li>
<p>before之前，after之后</p>
</li>
<li>
<p>sql关键字：insert、delete、updata、select...</p>
</li>
<li>
<p>是日志原理</p>
</li>
</ul>
<hr>
<h2 id="性能分析">性能分析 </h2>
<p>查询当前数据库各操作频率</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-show">show</span> <span class="token keyword keyword-global">global</span> <span class="token keyword keyword-status">status</span> <span class="token operator">like</span> <span class="token string">'com_______'</span><span class="token punctuation">;</span>    <span class="token comment">//7为数占位符</span>
</code></pre><ul>
<li>status：系统状态，variables：sql系统变量</li>
</ul>
<p>慢查询日志</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-set">set</span> slow_query_log <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">//打开慢查询日志</span>
<span class="token keyword keyword-set">set</span> long_query_time <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token comment">//长查询时间达到几s，记入日志</span>
</code></pre><p>查看所有语句耗时</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-select">select</span> @<span class="token variable">@have_profiling</span><span class="token punctuation">;</span>    <span class="token comment">//是否支持profiles</span>
<span class="token keyword keyword-select">select</span> @<span class="token variable">@profiling</span><span class="token punctuation">;</span>    <span class="token comment">//查询profiles参数</span>
<span class="token keyword keyword-set">set</span> profiling <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">//打开profiles</span>

<span class="token keyword keyword-show">show</span> profiles<span class="token punctuation">;</span>
<span class="token keyword keyword-show">show</span> profiles <span class="token keyword keyword-for">for</span> query 序号<span class="token punctuation">;</span>
<span class="token keyword keyword-show">show</span> profiles cpu <span class="token keyword keyword-for">for</span> query 序号<span class="token punctuation">;</span>
</code></pre><p>查看执行计划</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-explain">explain</span> 被分析语句<span class="token punctuation">;</span>
</code></pre><hr>
<h2 id="事务">事务 </h2>
<h3 id="事务特性">事务特性 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">事务特性</th>
<th style="text-align:center">表示</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">原子性</td>
<td style="text-align:center">A</td>
</tr>
<tr>
<td style="text-align:center">一致性</td>
<td style="text-align:center">C</td>
</tr>
<tr>
<td style="text-align:center">隔离性</td>
<td style="text-align:center">I</td>
</tr>
<tr>
<td style="text-align:center">持久性</td>
<td style="text-align:center">D</td>
</tr>
</tbody>
</table>
<ul>
<li>ACD实现依赖于重做日志redo log，撤销日志undo log</li>
</ul>
<hr>
<h3 id="事务过程">事务过程 </h3>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-start">start</span> <span class="token keyword keyword-transaction">transaction</span><span class="token punctuation">;</span>    <span class="token comment">//事务开始</span>

<span class="token keyword keyword-begin">begin</span><span class="token punctuation">;</span>    <span class="token comment">//同上</span>

<span class="token keyword keyword-commit">commit</span><span class="token punctuation">;</span>    <span class="token comment">//事务提交</span>

<span class="token keyword keyword-rollback">rollback</span><span class="token punctuation">;</span>    <span class="token comment">//事务回滚</span>
</code></pre><hr>
<h3 id="事务并发问题">事务并发问题 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">事务并发执行产生问题</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">脏读</td>
<td style="text-align:center">读到其他事务未提交的数据</td>
</tr>
<tr>
<td style="text-align:center">不可重复读</td>
<td style="text-align:center">同一事务，两次查询数据不同</td>
</tr>
<tr>
<td style="text-align:center">幻读</td>
<td style="text-align:center">查的时候没有，插入却有而无法插入</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="事务隔离与mvcc">事务隔离与MVCC </h3>
<p><strong>概念</strong>：通过事务隔离，解决并发问题</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-select">select</span> @<span class="token variable">@transaction_isolation</span><span class="token punctuation">;</span>

<span class="token keyword keyword-set">set</span> <span class="token keyword keyword-global">global</span> <span class="token keyword keyword-transaction">transaction</span> <span class="token keyword keyword-isolation">isolation</span> <span class="token keyword keyword-level">level</span> 隔离级别<span class="token punctuation">;</span>

<span class="token keyword keyword-set">set</span> <span class="token keyword keyword-session">session</span> <span class="token keyword keyword-transaction">transaction</span> <span class="token keyword keyword-isolation">isolation</span> <span class="token keyword keyword-level">level</span> 隔离级别<span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th style="text-align:center">隔离级别</th>
<th style="text-align:center">解决</th>
<th style="text-align:center">性能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">read uncommitted</td>
<td style="text-align:center">\</td>
<td style="text-align:center">高</td>
</tr>
<tr>
<td style="text-align:center">read committed</td>
<td style="text-align:center">脏读</td>
<td style="text-align:center">较高</td>
</tr>
<tr>
<td style="text-align:center">repeatable read</td>
<td style="text-align:center">脏读、不可重复读</td>
<td style="text-align:center">较低</td>
</tr>
<tr>
<td style="text-align:center">serializable</td>
<td style="text-align:center">脏读、不可重复度、幻读</td>
<td style="text-align:center">低</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>可重复读依赖于，在第一次读时，生成的快照读文件</p>
</li>
<li>
<p>事务隔离中read committed、repeatable read底层原理是MVCC</p>
</li>
</ul>
<hr>
<p><strong>MVCC概念</strong>：多版本并发控制，维护一个数据多个版本，使读写没有冲突。</p>
<p><strong>基于</strong>：undolog、版本链、readview</p>
<img src="./images/2023-08-03-19-54-image.png">
<table>
<thead>
<tr>
<th style="text-align:center">readview记录内容</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">m_ids</td>
<td style="text-align:center">活跃事务id</td>
</tr>
<tr>
<td style="text-align:center">min_trx_id</td>
<td style="text-align:center">活跃事务中的最小事务id</td>
</tr>
<tr>
<td style="text-align:center">max_trx_id</td>
<td style="text-align:center">活跃事务的下一个事务id</td>
</tr>
<tr>
<td style="text-align:center">creator_trx_id</td>
<td style="text-align:center">本事务id</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">读写控制判断</th>
<th style="text-align:center">控制内容</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">trx_id == creator_trx_id</td>
<td style="text-align:center">可访问此版本</td>
</tr>
<tr>
<td style="text-align:center">trx_id &lt; min_trx_id</td>
<td style="text-align:center">可访问此版本</td>
</tr>
<tr>
<td style="text-align:center">trx_id &gt; max_trx_id</td>
<td style="text-align:center">不可访问此版本</td>
</tr>
<tr>
<td style="text-align:center">min_trx_id &lt; trx_id &lt; max_trx_id</td>
<td style="text-align:center">若在m_ids中不可访问，否则可访问</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="封锁">封锁 </h3>
<p><strong>概念</strong>：事务执行操作时，对表加锁，解决并发问题</p>
<table>
<thead>
<tr>
<th style="text-align:center">两种锁</th>
<th style="text-align:center">简记</th>
<th style="text-align:center">别名</th>
<th style="text-align:center">允许其他事务一起</th>
<th style="text-align:center">禁止其他事务一起</th>
<th style="text-align:center">可叠加锁</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">排它锁</td>
<td style="text-align:center">X</td>
<td style="text-align:center">写锁</td>
<td style="text-align:center">\</td>
<td style="text-align:center">读、写</td>
<td style="text-align:center">\</td>
</tr>
<tr>
<td style="text-align:center">共享锁</td>
<td style="text-align:center">S</td>
<td style="text-align:center">读锁</td>
<td style="text-align:center">读</td>
<td style="text-align:center">写</td>
<td style="text-align:center">S</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">三级封锁协议</th>
<th style="text-align:center">基础</th>
<th style="text-align:center">何时加锁</th>
<th style="text-align:center">加什么锁</th>
<th style="text-align:center">何时释放</th>
<th style="text-align:center">解决问题</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1级封锁协议</td>
<td style="text-align:center">\</td>
<td style="text-align:center">写</td>
<td style="text-align:center">X</td>
<td style="text-align:center">写完</td>
<td style="text-align:center">\</td>
</tr>
<tr>
<td style="text-align:center">2级封锁协议</td>
<td style="text-align:center">1级封锁</td>
<td style="text-align:center">读</td>
<td style="text-align:center">S</td>
<td style="text-align:center">读完</td>
<td style="text-align:center">脏读</td>
</tr>
<tr>
<td style="text-align:center">3级封锁协议</td>
<td style="text-align:center">1级封锁</td>
<td style="text-align:center">读</td>
<td style="text-align:center">S</td>
<td style="text-align:center">事务完成</td>
<td style="text-align:center">脏读、不可重复读</td>
</tr>
</tbody>
</table>
<ul>
<li>两段锁协议：事务开始到提交前都是加锁阶段，只能叠加锁，事务提交时属于解锁阶段，不能再进叠加锁操作。</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code>flush <span class="token keyword keyword-tables">tables</span> <span class="token keyword keyword-with">with</span> <span class="token keyword keyword-read">read</span> <span class="token keyword keyword-lock">lock</span><span class="token punctuation">;</span>    <span class="token comment">//全局加共享锁</span>

<span class="token keyword keyword-unlock">unlock</span> <span class="token keyword keyword-tables">tables</span><span class="token punctuation">;</span>    <span class="token comment">//全局解共享锁</span>

<span class="token keyword keyword-lock">lock</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-read">read</span><span class="token punctuation">;</span>    <span class="token comment">//表加共享锁</span>

<span class="token keyword keyword-lock">lock</span> <span class="token keyword keyword-table">table</span> 表名 <span class="token keyword keyword-write">write</span><span class="token punctuation">;</span>    <span class="token comment">//表加排他锁</span>

DQL语句 <span class="token keyword keyword-lock">lock</span> <span class="token operator">in</span> <span class="token keyword keyword-share">share</span> <span class="token keyword keyword-mode">mode</span>    <span class="token comment">//行加共享锁查询</span>

DQL语句 <span class="token keyword keyword-for">for</span> <span class="token keyword keyword-share">share</span>    <span class="token comment">//行加共享锁查询</span>

DQL语句 <span class="token keyword keyword-for">for</span> <span class="token keyword keyword-update">update</span>    <span class="token comment">//行加排它锁查询</span>
</code></pre><ul>
<li>根据锁的范围分类：全局锁、表锁、行锁、间隙锁</li>
</ul>
<hr>
<h2 id="客户端指令">客户端指令 </h2>
<p><strong>概念</strong>：在命令行的工作目录下执行的语句。</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code>mysql <span class="token operator">-</span>h 主机 <span class="token operator">-</span>P <span class="token number">3306</span> <span class="token operator">-</span>u 用户名 <span class="token operator">-</span>p 密码 数据库名 <span class="token operator">-</span>e <span class="token string">'SQL语句'</span>

mysqladmin <span class="token comment">--help</span>

mysqladmin <span class="token operator">-</span>u 用户名 <span class="token operator">-</span>p 密码 <span class="token keyword keyword-create">create</span> 数据库名

mysqlshow <span class="token operator">-</span>u 用户名 <span class="token operator">-</span>p 密码 数据库名 <span class="token comment">--count -i</span>

mysqlimport <span class="token operator">-</span>u 用户名 <span class="token operator">-</span>p 密码 数据库名 txt文件路径

<span class="token comment">//备份</span>
mysqldump <span class="token comment">--single-transaction -u用户名 -p密码 数据库名 &gt; 路径</span>

<span class="token comment">//备份文件导入，在sql内的，数据库下执行的语句</span>
source 路径
</code></pre><hr>
<h2 id="故障与备份">故障与备份 </h2>
<p>故障分类：事务故障、系统故障、介质故障</p>
<p>从什么地方恢复：转储/备份、日志文件转储分类：静态转储、动态转储、海量转储、增量转储</p>
<p>数据库复制分类：对等复制，主从复制，级联复制</p>
<p>数据库镜像：关键数据复制，能实现同时读写</p>
<hr>
<h3 id="日志">日志 </h3>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">sql变量</th>
<th style="text-align:center">记录情况</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">错误日志</td>
<td style="text-align:center">log_error</td>
<td style="text-align:center">执行错误</td>
</tr>
<tr>
<td style="text-align:center">二进制日志</td>
<td style="text-align:center">log_bin</td>
<td style="text-align:center">所有变化</td>
</tr>
<tr>
<td style="text-align:center">查询日志</td>
<td style="text-align:center">general_log</td>
<td style="text-align:center">查询</td>
</tr>
<tr>
<td style="text-align:center">慢查询日志</td>
<td style="text-align:center">slow_query_log</td>
<td style="text-align:center">慢执行</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="主从配置">主从配置 </h3>
<p>防火墙配置</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">//Linux开放防火墙端口</span>
firewall <span class="token operator">-</span>cmd <span class="token comment">--zone=public --add-port=3306/tcp --permanent</span>
firewall <span class="token operator">-</span>cmd <span class="token comment">--reload</span>

<span class="token comment">//Linux直接关闭防火墙</span>
systemctl stop firewalld

systemctl disabled firewalld

<span class="token comment">//Linux查看mysql进程状态</span>
systemctl statue mysqld
</code></pre><p>主库配置</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">//Linux文件/etc/my.cnf下配置增加</span>
server<span class="token operator">-</span>id＝<span class="token number">1</span>
<span class="token keyword keyword-read">read</span><span class="token operator">-</span>only＝<span class="token number">0</span>
<span class="token comment">//Linux重启mysql服务器</span>
systemctl restart mysqld
<span class="token comment">//sql创建远程连接用户，授权，查看坐标</span>
<span class="token keyword keyword-create">create</span> <span class="token keyword keyword-user">user</span> <span class="token string">'用户名'</span><span class="token variable">@'%'</span> indentified <span class="token keyword keyword-with">with</span> mysql_native_password <span class="token keyword keyword-by">by</span> <span class="token string">'密码'</span><span class="token punctuation">;</span>
<span class="token keyword keyword-grant">grant</span> <span class="token keyword keyword-replication">replication</span> slave <span class="token keyword keyword-on">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword keyword-to">to</span> <span class="token string">'用户名'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token comment">//Linux查看主库状态</span>
<span class="token keyword keyword-show">show</span> master statue
</code></pre><p>从库配置</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">//Linux文件/etc/my.cnf下配置增加</span>
server<span class="token operator">-</span>id＝<span class="token number">2</span>
<span class="token keyword keyword-read">read</span><span class="token operator">-</span>only＝<span class="token number">1</span>
<span class="token comment">//Linux重启mysql服务器</span>
systemctl restart mysqld
<span class="token operator">/</span>Linux连接主库，开启同步
change source <span class="token keyword keyword-to">to</span> source_host<span class="token operator">/</span>_user<span class="token operator">/</span>_password<span class="token operator">/</span>_log_file<span class="token operator">/</span>_log_pos
<span class="token keyword keyword-start">start</span> replica
<span class="token comment">//Linux查看从库状态</span>
<span class="token keyword keyword-show">show</span> replica statue
</code></pre><hr>
<h2 id="分库分表">分库分表 </h2>
<p><strong>概念</strong>：一个数据库的数据分布在多个服务器</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">说明，</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">垂直分片</td>
<td style="text-align:center">以表为分片依据</td>
</tr>
<tr>
<td style="text-align:center">水平分片</td>
<td style="text-align:center">以元组为分片依据</td>
</tr>
</tbody>
</table>
<ul>
<li>可使用<strong>Mycat</strong>：用java编写的MySQL中间件</li>
</ul>

      </div>
      <script src="./nav.js"></script>
      
    
    
    
    
    
    
  
    </body></html>